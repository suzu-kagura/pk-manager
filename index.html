<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒã‚±ã‚¹ãƒªå³é¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼</title>
    <style>
        :root {
            --primary: #4a90e2;
            --bg: #f0f4f8;
            --card-bg: #ffffff;
            --danger: #ff6b6b;
            --gold-skill: #ffd700;
            --blue-skill: #87ceeb;
            --white-skill: #f0f0f0;
            --text-dark: #333;
        }
        body { font-family: "Helvetica Neue", Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; background-color: var(--bg); color: var(--text-dark); }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 20px; }

        .panel { background: var(--card-bg); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; }

        /* ãƒ•ã‚©ãƒ¼ãƒ è¦ç´  */
        label { font-weight: bold; display: block; margin-top: 15px; font-size: 0.85rem; margin-bottom: 5px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 0.95rem; }
        
        .row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .subskill-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; }
        .subskill-group label { margin-top: 0; font-size: 0.75rem; color: #888; }

        /* ãƒœã‚¿ãƒ³ */
        .btn { border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: bold; width: 100%; margin-top: 20px; }
        .btn-add { background-color: #2ecc71; color: white; }
        .io-actions { display: flex; gap: 10px; margin-bottom: 20px; }
        .btn-dl { background-color: var(--primary); color: white; flex: 1; }
        .btn-imp { background-color: #9b59b6; color: white; flex: 1; }
        #file-input { display: none; }

        /* ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆã“ã“ãŒé‡è¦ï¼‰ */
        #pokemon-list { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 15px; 
        }

        .card { 
            background: white; border-radius: 8px; padding: 12px; 
            border-top: 6px solid #ccc; box-shadow: 0 2px 4px rgba(0,0,0,0.05); 
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .card.has-gold { border-top-color: var(--gold-skill); }
        
        .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; }
        .card-title { font-size: 1.1rem; font-weight: bold; }
        .btn-del { background: none; border: none; color: #ccc; cursor: pointer; font-size: 1.2rem; line-height: 1; }
        .btn-del:hover { color: var(--danger); }
        
        .info-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; font-size: 0.85rem; }
        .nature-up { color: #e74c3c; font-weight: bold; }
        .nature-down { color: #3498db; font-weight: bold; }

        /* é£Ÿæã¯çµµæ–‡å­—ã®ã¿ */
        .ing-emoji-list { font-size: 1.2rem; letter-spacing: 2px; }

        .skills-list { display: flex; flex-wrap: wrap; gap: 4px; }
        .skill-tag { padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; background: var(--white-skill); border: 1px solid #ddd; }
        .skill-gold { background: #fff9c4; border: 1px solid #fbc02d; color: #5f4306; font-weight: bold;}
        .skill-blue { background: #e1f5fe; border: 1px solid #4fc3f7; color: #0277bd; }
    </style>
</head>
<body>

    <h1>ğŸ˜´ ãƒã‚±ã‚¹ãƒªå³é¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼</h1>

    <div class="io-actions">
        <button class="btn btn-dl" onclick="exportData()">ğŸ’¾ ä¿å­˜ (Export)</button>
        <button class="btn btn-imp" onclick="document.getElementById('file-input').click()">ğŸ“‚ èª­è¾¼ (Import)</button>
        <input type="file" id="file-input" accept=".json" onchange="importData(this)">
    </div>

    <div class="panel">
        <label>ãƒã‚±ãƒ¢ãƒ³å</label>
        <input type="text" id="p-name" placeholder="ä¾‹: ãƒ©ã‚¤ãƒãƒ¥ã‚¦">

        <label>æ€§æ ¼</label>
        <select id="p-nature" onchange="updateNaturePreview()"></select>
        <div id="nature-preview" style="font-size:0.8rem; margin-top:4px; min-height:1em;"></div>

        <label>é£Ÿæ (Lv1 / 30 / 60)</label>
        <div class="row-3">
            <select id="ing-1" class="ing-select"></select>
            <select id="ing-30" class="ing-select"></select>
            <select id="ing-60" class="ing-select"></select>
        </div>

        <label>ã‚µãƒ–ã‚¹ã‚­ãƒ«</label>
        <div class="subskill-grid">
            <div class="subskill-group"><label>Lv10</label><select class="subskill-select"></select></div>
            <div class="subskill-group"><label>Lv25</label><select class="subskill-select"></select></div>
            <div class="subskill-group"><label>Lv50</label><select class="subskill-select"></select></div>
            <div class="subskill-group"><label>Lv75</label><select class="subskill-select"></select></div>
            <div class="subskill-group"><label>Lv100</label><select class="subskill-select"></select></div>
        </div>

        <button class="btn btn-add" onclick="addPokemon()">ãƒã‚±ãƒ¢ãƒ³ã‚’ç™»éŒ²</button>
    </div>

    <div class="panel">
        <input type="text" id="search-box" placeholder="ğŸ” åå‰ãƒ»ã‚¹ã‚­ãƒ«ãƒ»çµµæ–‡å­—ã§æ¤œç´¢..." onkeyup="loadPokemon()" style="margin-bottom:15px;">
        <div id="pokemon-list"></div>
    </div>

    <script>
        const INGREDIENTS = [
            {n:"ç‰¹é¸ãƒªãƒ³ã‚´", e:"ğŸ"}, {n:"ãƒ¢ãƒ¼ãƒ¢ãƒ¼ãƒŸãƒ«ã‚¯", e:"ğŸ¥›"}, {n:"ãƒ¯ã‚«ã‚¯ã‚µå¤§è±†", e:"ğŸ«˜"}, {n:"ã‚ã¾ã„ãƒŸãƒ„", e:"ğŸ¯"},
            {n:"ãƒãƒ¡ãƒŸãƒ¼ãƒˆ", e:"ğŸŒ­"}, {n:"ã‚ã£ãŸã‹ã‚¸ãƒ³ã‚¸ãƒ£ãƒ¼", e:"ğŸ«š"}, {n:"ã‚ã‚“ã¿ã‚“ãƒˆãƒãƒˆ", e:"ğŸ…"}, {n:"ã¨ãã›ã‚“ã‚¨ãƒƒã‚°", e:"ğŸ¥š"},
            {n:"ãƒ”ãƒ¥ã‚¢ãªã‚ªã‚¤ãƒ«", e:"ğŸ«’"}, {n:"ã»ã£ã“ã‚Šãƒãƒ†ãƒˆ", e:"ğŸ¥”"}, {n:"ã’ãã‹ã‚‰ãƒãƒ¼ãƒ–", e:"ğŸŒ¿"}, {n:"ãƒ¯ã‚«ã‚¯ã‚µã‚³ãƒ¼ãƒ³", e:"ğŸŒ½"},
            {n:"ãƒªãƒ©ãƒƒã‚¯ã‚¹ã‚«ã‚«ã‚ª", e:"ğŸ«"}, {n:"ã‚ã˜ã‚ã„ã‚­ãƒã‚³", e:"ğŸ„"}, {n:"ãµã¨ã„ãªãŒã­ã", e:"ğŸŒ±"}, {n:"ãŠã„ã—ã„ã‚·ãƒƒãƒ", e:"ğŸ–"}, {n:"ã‚ã–ã¾ã—ã‚³ãƒ¼ãƒ’ãƒ¼", e:"â˜•"}
        ];

        const NATURES = {
            "ã¾ã˜ã‚": {up: null, down: null}, "ãŒã‚“ã°ã‚Šã‚„": {up: null, down: null}, "ã™ãªãŠ": {up: null, down: null}, "ãã¾ãã‚Œ": {up: null, down: null}, "ã¦ã‚Œã‚„": {up: null, down: null},
            "ã•ã¿ã—ãŒã‚Š": {up: "ãŠæ‰‹ä¼ã„", down: "å…ƒæ°—"}, "ã„ã˜ã£ã±ã‚Š": {up: "ãŠæ‰‹ä¼ã„", down: "é£Ÿæ"}, "ã‚„ã‚“ã¡ã‚ƒ": {up: "ãŠæ‰‹ä¼ã„", down: "ã‚¹ã‚­ãƒ«"}, "ã‚†ã†ã‹ã‚“": {up: "ãŠæ‰‹ä¼ã„", down: "EXP"},
            "ãšã¶ã¨ã„": {up: "å…ƒæ°—", down: "ãŠæ‰‹ä¼ã„"}, "ã‚ã‚“ã±ã": {up: "å…ƒæ°—", down: "é£Ÿæ"}, "ã®ã†ã¦ã‚“ã": {up: "å…ƒæ°—", down: "ã‚¹ã‚­ãƒ«"}, "ã®ã‚“ã": {up: "å…ƒæ°—", down: "EXP"},
            "ã²ã‹ãˆã‚": {up: "é£Ÿæ", down: "ãŠæ‰‹ä¼ã„"}, "ãŠã£ã¨ã‚Š": {up: "é£Ÿæ", down: "å…ƒæ°—"}, "ã†ã£ã‹ã‚Šã‚„": {up: "é£Ÿæ", down: "ã‚¹ã‚­ãƒ«"}, "ã‚Œã„ã›ã„": {up: "é£Ÿæ", down: "EXP"},
            "ãŠã ã‚„ã‹": {up: "ã‚¹ã‚­ãƒ«", down: "ãŠæ‰‹ä¼ã„"}, "ãŠã¨ãªã—ã„": {up: "ã‚¹ã‚­ãƒ«", down: "å…ƒæ°—"}, "ã—ã‚“ã¡ã‚‡ã†": {up: "ã‚¹ã‚­ãƒ«", down: "é£Ÿæ"}, "ãªã¾ã„ã": {up: "ã‚¹ã‚­ãƒ«", down: "EXP"},
            "ãŠãã³ã‚‡ã†": {up: "EXP", down: "ãŠæ‰‹ä¼ã„"}, "ã›ã£ã‹ã¡": {up: "EXP", down: "å…ƒæ°—"}, "ã‚ˆã†ã": {up: "EXP", down: "é£Ÿæ"}, "ã‚€ã˜ã‚ƒã": {up: "EXP", down: "ã‚¹ã‚­ãƒ«"}
        };

        // ã‚µãƒ–ã‚¹ã‚­ãƒ«ã®è‰²åˆ†é¡ä¿®æ­£
        const SKILLS_GOLD = ["ãã®ã¿ã®æ•°S", "ãŠã¦ã¤ã ã„ãƒœãƒ¼ãƒŠã‚¹", "ç¡çœ EXPãƒœãƒ¼ãƒŠã‚¹", "ãƒªã‚µãƒ¼ãƒEXPãƒœãƒ¼ãƒŠã‚¹", "ã‚†ã‚ã®ã‹ã‘ã‚‰ãƒœãƒ¼ãƒŠã‚¹", "å…ƒæ°—å›å¾©ãƒœãƒ¼ãƒŠã‚¹"];
        const SKILLS_BLUE = ["ãŠã¦ã¤ã ã„ã‚¹ãƒ”ãƒ¼ãƒ‰M", "é£Ÿæç¢ºç‡ã‚¢ãƒƒãƒ—M", "ã‚¹ã‚­ãƒ«ç¢ºç‡ã‚¢ãƒƒãƒ—M", "æœ€å¤§æ‰€æŒæ•°ã‚¢ãƒƒãƒ—L", "æœ€å¤§æ‰€æŒæ•°ã‚¢ãƒƒãƒ—M", "ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—M"];
        const SKILLS_WHITE = ["ãŠã¦ã¤ã ã„ã‚¹ãƒ”ãƒ¼ãƒ‰S", "é£Ÿæç¢ºç‡ã‚¢ãƒƒãƒ—S", "ã‚¹ã‚­ãƒ«ç¢ºç‡ã‚¢ãƒƒãƒ—S", "æœ€å¤§æ‰€æŒæ•°ã‚¢ãƒƒãƒ—S", "ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—S"];

        document.addEventListener('DOMContentLoaded', () => {
            initSelects();
            loadPokemon();
        });

        function initSelects() {
            const natureSel = document.getElementById('p-nature');
            Object.keys(NATURES).forEach(n => natureSel.add(new Option(n, n)));
            natureSel.value = "ã„ã˜ã£ã±ã‚Š";
            updateNaturePreview();

            document.querySelectorAll('.ing-select').forEach(sel => {
                sel.add(new Option("---", ""));
                INGREDIENTS.forEach(i => sel.add(new Option(`${i.e} ${i.n}`, i.e)));
            });

            document.querySelectorAll('.subskill-select').forEach(sel => {
                sel.add(new Option("---", ""));
                const addGrp = (label, list) => {
                    const grp = document.createElement('optgroup'); grp.label = label;
                    list.forEach(s => grp.add(new Option(s, s)));
                    sel.add(grp);
                };
                addGrp("é‡‘ã‚¹ã‚­ãƒ«", SKILLS_GOLD);
                addGrp("é’ã‚¹ã‚­ãƒ«", SKILLS_BLUE);
                addGrp("ç™½ã‚¹ã‚­ãƒ«", SKILLS_WHITE);
            });
        }

        function updateNaturePreview() {
            const d = NATURES[document.getElementById('p-nature').value];
            document.getElementById('nature-preview').innerHTML = d.up ? `<span class="nature-up">â–²${d.up}</span> <span class="nature-down">â–¼${d.down}</span>` : "è£œæ­£ãªã—";
        }

        function addPokemon() {
            const name = document.getElementById('p-name').value;
            if (!name) return alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
            const skills = Array.from(document.querySelectorAll('.subskill-select')).map(s => s.value);
            const ings = Array.from(document.querySelectorAll('.ing-select')).map(s => s.value);
            
            const list = getList();
            list.push({ id: Date.now(), name, nature: document.getElementById('p-nature').value, ingredients: ings, subskills: skills });
            saveList(list);
            location.reload(); // ç°¡æ˜“ã‚¯ãƒªã‚¢
        }

        function getList() { return JSON.parse(localStorage.getItem('pokeSleepData')) || []; }
        function saveList(list) { localStorage.setItem('pokeSleepData', JSON.stringify(list)); }

        function loadPokemon() {
            const container = document.getElementById('pokemon-list');
            container.innerHTML = "";
            const search = document.getElementById('search-box').value.toLowerCase();
            
            getList().reverse().filter(p => (p.name + p.ingredients.join('') + p.subskills.join('')).toLowerCase().includes(search)).forEach(p => {
                const card = document.createElement('div');
                card.className = `card ${p.subskills.includes("ãã®ã¿ã®æ•°S") ? 'has-gold' : ''}`;
                
                const n = NATURES[p.nature];
                const natureHtml = n.up ? `<span class="nature-up">â–²${n.up[0]}</span><span class="nature-down">â–¼${n.down[0]}</span>` : '--';

                card.innerHTML = `
                    <div class="card-header">
                        <span class="card-title">${p.name}</span>
                        <button class="btn-del" onclick="deletePokemon(${p.id})">Ã—</button>
                    </div>
                    <div class="info-row">
                        <span style="font-weight:bold; color:#666;">${p.nature} ${natureHtml}</span>
                        <div class="ing-emoji-list">${p.ingredients.join('')}</div>
                    </div>
                    <div class="skills-list">
                        ${p.subskills.map((s, idx) => {
                            if(!s) return '';
                            let cls = "skill-tag";
                            if(SKILLS_GOLD.includes(s)) cls += " skill-gold";
                            else if(SKILLS_BLUE.includes(s)) cls += " skill-blue";
                            return `<span class="${cls}">${s}</span>`;
                        }).join('')}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function deletePokemon(id) {
            if(confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                saveList(getList().filter(p => p.id !== id));
                loadPokemon();
            }
        }

        function exportData() {
            const blob = new Blob([JSON.stringify(getList(), null, 2)], {type: "application/json"});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `pokesleep_data_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
        }

        function importData(input) {
            const reader = new FileReader();
            reader.onload = (e) => {
                saveList(JSON.parse(e.target.result));
                loadPokemon();
            };
            reader.readAsText(input.files[0]);
        }
    </script>
</body>
</html>
